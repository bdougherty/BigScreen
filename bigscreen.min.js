// BigScreen v2.1.0 - 2014-09-30 - Apache 2.0 License
!function(a,b,c){"use strict";function d(){var a=Array.prototype.slice.apply(arguments),b=a.shift();p[b].forEach(function(b){"function"==typeof b&&b.apply(b,a)})}function e(a){return function(b,c){-1!==o.indexOf(b)&&a.call(this,b,c)}}function f(a){var b=null;if("VIDEO"===a.tagName)b=a;else{var c=a.getElementsByTagName("video");c[0]&&(b=c[0])}return b}function g(a){var b=f(a);if(b&&b.webkitEnterFullscreen){try{b.readyState<b.HAVE_METADATA?(b.addEventListener("loadedmetadata",function d(){b.removeEventListener("loadedmetadata",d,!1),b.webkitEnterFullscreen(),r=!!b.getAttribute("controls")},!1),b.load()):(b.webkitEnterFullscreen(),r=!!b.getAttribute("controls")),q=b}catch(c){return x("not_supported",a)}return!0}return x(void 0===m.request?"not_supported":"not_enabled",a)}function h(){y.element||(w(),j())}function i(){c&&"webkitfullscreenchange"===m.change&&a.addEventListener("resize",h,!1)}function j(){c&&"webkitfullscreenchange"===m.change&&a.removeEventListener("resize",h,!1)}var k="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,l=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10)>=7,m=function(){var a=b.createElement("video"),c={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},d={};for(var e in c)for(var f=0,g=c[e].length;g>f;f++)if(c[e][f]in a||c[e][f]in b||"on"+c[e][f].toLowerCase()in b){d[e]=c[e][f];break}return d}(),n={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},o=[],p={};Object.keys(n).forEach(function(a){o.push(n[a]),p[n[a]]=[]});var q=null,r=null,s=function(){},t=[],u=!1;navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Chrome")>-1&&(u=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0);var v=function(a){var b=t[t.length-1];b||(a!==b.element&&a!==q||!b.hasEntered)&&("VIDEO"===a.tagName&&(q=a),1===t.length&&y.onenter(y.element),b.enter.call(b.element,a||b.element),b.hasEntered=!0,d(n.ENTER,y.element))},w=function(){!q||r||l||(q.setAttribute("controls","controls"),q.removeAttribute("controls")),q=null,r=null;var a=t.pop();a&&(a.exit.call(a.element),d(n.EXIT,a.element),y.element||(t.forEach(function(a){a.exit.call(a.element),d(n.EXIT,a.element)}),t=[],y.onexit()))},x=function(a,b){if(t.length>0){var c=t.pop();b=b||c.element,c.error.call(b,a),y.onerror(b,a),d(n.ERROR,b,a)}},y={request:function(a,d,e,f){if(a=a||b.body,t.push({element:a,enter:d||s,exit:e||s,error:f||s}),void 0===m.request)return g(a);if(c&&b[m.enabled]===!1)return g(a);if(u!==!1&&32>u)return g(a);if(c&&void 0===m.enabled)return m.enabled="webkitFullscreenEnabled",a[m.request](),void setTimeout(function(){b[m.element]?b[m.enabled]=!0:(b[m.enabled]=!1,g(a))},250);try{/5\.1[\.\d]* Safari/.test(navigator.userAgent)?a[m.request]():a[m.request](k&&Element.ALLOW_KEYBOARD_INPUT),setTimeout(function(){b[m.element]||x(c?"not_enabled":"not_allowed",a)},100)}catch(h){x("not_enabled",a)}},exit:function(){j(),b[m.exit]()},toggle:function(a,b,c,d){y.element?y.exit():y.request(a,b,c,d)},videoEnabled:function(a){if(y.enabled)return!0;a=a||b.body;var c=f(a);return c&&void 0!==c.webkitSupportsFullscreen?c.readyState<c.HAVE_METADATA?"maybe":c.webkitSupportsFullscreen:!1},on:e(function(a,b){p[a].push(b)}),off:e(function(a,b){var c=p[a].indexOf(b);c>-1&&p[a].splice(c,1)}),onenter:s,onexit:s,onchange:s,onerror:s};try{Object.defineProperties(y,{element:{enumerable:!0,get:function(){return q&&q.webkitDisplayingFullscreen?q:b[m.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"!==m.exit||c?u!==!1&&32>u?!1:b[m.enabled]||!1:!0}}})}catch(z){y.element=null,y.enabled=!1}m.change&&b.addEventListener(m.change,function(){if(y.onchange(y.element),d(n.CHANGE,y.element),y.element){var a=t[t.length-2];a&&a.element===y.element?w():(v(y.element),i())}else w()},!1),b.addEventListener("webkitbeginfullscreen",function(a){var b=!0;if(t.length>0)for(var c=0,e=t.length;e>c;c++){var g=f(t[c].element);if(g===a.srcElement){b=!1;break}}b&&t.push({element:a.srcElement,enter:s,exit:s,error:s}),y.onchange(a.srcElement),d(n.CHANGE,y.srcElement),v(a.srcElement)},!0),b.addEventListener("webkitendfullscreen",function(a){y.onchange(a.srcElement),d(n.CHANGE,a.srcElement),w(a.srcElement)},!0),m.error&&b.addEventListener(m.error,function(){x("not_allowed")},!1),a.BigScreen=y}(window,document,self!==top);